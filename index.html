<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de Aplicativos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: center;
            padding: 20px;
        }

        .card {
            width: 200px;
            padding: 15px;
            margin: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-align: center;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.3s ease-in-out;
            cursor: grab; /* Torna o cursor uma mãozinha quando você passa sobre o card */
        }

        .card:hover {
            box-shadow: 0px 0px 20px rgba(0, 0, 0, 0.2);
        }

        .card img {
            transition: transform 0.3s ease-in-out;
        }

        .button {
            display: inline-block;
            margin-top: 10px;
            padding: 10px;
            background-color: #3498db;
            color: #fff;
            text-decoration: none;
            border-radius: 5px;
        }

        .card:hover img {
            transform: scale(1.2);
        }

        .drag-over {
            border: 2px dashed #3498db;
        }
    </style>
</head>
<body>

    <button id="Teste" onclick="teste"></button>


<!-- Variáveis JavaScript -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/localforage/1.10.0/localforage.min.js"></script>

<script>

function teste() {
        const { exec } = require('child_process');

    // Substitua 'seu_programa.exe' pelo caminho real do seu executável
    const programaExe = 'C:/Users/ferna/AppData/Local/Programs/Microsoft VS Code/Code.exe';

    exec(programaExe, (error, stdout, stderr) => {
    if (error) {
        console.error(`Erro ao executar o programa: ${error.message}`);
        return;
    }
    if (stderr) {
        console.error(`Erro do programa: ${stderr}`);
        return;
    }
    console.log(`Saída do programa: ${stdout}`);
    });

}

    var appData = [

        {
            text1: "SAP 110",
            link: "",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48"%3E%3Cpath fill="%231976d2" d="M0,12v24h25l23-24H0z"%3E%3C/path%3E%3Cpath fill="%23fff" d="M27.5,18H23v7v2v0.5L19.2,18h-3.5l-3.088,7.883c-0.405-1.752-2.259-2.417-3.412-2.683C6.2,22.4,6,22,6,21.4c0-1.5,4-0.8,5-0.4c0.3-0.8,0.9-2.3,0.9-2.3S10.8,18,7.4,18C4,18,3,20.1,3,21.4c0,1.3,0.7,2.8,2.6,3.4c2,0.6,3.5,0.7,3.5,1.7s-3.4,1.2-5.3,0L3,29.1c0,0,1.1,0.9,4.4,0.9c1.781,0,3.167-0.503,4.08-1.226L11,30h3.5l0.6-1.8c0.7,0.3,1.5,0.5,2.4,0.5s1.7-0.2,2.4-0.5l0.6,1.8H23h1h2v-3h1.5c2.5,0,4.5-2,4.5-4.5S30,18,27.5,18z M17.5,26.1c-0.6,0-1.1-0.1-1.5-0.4l1.5-4.3l1.5,4.3C18.6,26,18.1,26.1,17.5,26.1z M27.5,24H26v-3h1.5c0.8,0,1.5,0.7,1.5,1.5S28.3,24,27.5,24z"%3E%3C/path%3E%3C/svg%3E',
            desc: "Ambiente Desenvolvimento",
            text: "Abrir"
        },
        {
            text1: "SAP 300",
            link: "",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48"%3E%3Cpath fill="%231976d2" d="M0,12v24h25l23-24H0z"%3E%3C/path%3E%3Cpath fill="%23fff" d="M27.5,18H23v7v2v0.5L19.2,18h-3.5l-3.088,7.883c-0.405-1.752-2.259-2.417-3.412-2.683C6.2,22.4,6,22,6,21.4c0-1.5,4-0.8,5-0.4c0.3-0.8,0.9-2.3,0.9-2.3S10.8,18,7.4,18C4,18,3,20.1,3,21.4c0,1.3,0.7,2.8,2.6,3.4c2,0.6,3.5,0.7,3.5,1.7s-3.4,1.2-5.3,0L3,29.1c0,0,1.1,0.9,4.4,0.9c1.781,0,3.167-0.503,4.08-1.226L11,30h3.5l0.6-1.8c0.7,0.3,1.5,0.5,2.4,0.5s1.7-0.2,2.4-0.5l0.6,1.8H23h1h2v-3h1.5c2.5,0,4.5-2,4.5-4.5S30,18,27.5,18z M17.5,26.1c-0.6,0-1.1-0.1-1.5-0.4l1.5-4.3l1.5,4.3C18.6,26,18.1,26.1,17.5,26.1z M27.5,24H26v-3h1.5c0.8,0,1.5,0.7,1.5,1.5S28.3,24,27.5,24z"%3E%3C/path%3E%3C/svg%3E',
            desc: "Ambiente Teste",
            text: "Abrir"
        },
        {
            text1: "SAP 310",
            link: "",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48"%3E%3Cpath fill="%231976d2" d="M0,12v24h25l23-24H0z"%3E%3C/path%3E%3Cpath fill="%23fff" d="M27.5,18H23v7v2v0.5L19.2,18h-3.5l-3.088,7.883c-0.405-1.752-2.259-2.417-3.412-2.683C6.2,22.4,6,22,6,21.4c0-1.5,4-0.8,5-0.4c0.3-0.8,0.9-2.3,0.9-2.3S10.8,18,7.4,18C4,18,3,20.1,3,21.4c0,1.3,0.7,2.8,2.6,3.4c2,0.6,3.5,0.7,3.5,1.7s-3.4,1.2-5.3,0L3,29.1c0,0,1.1,0.9,4.4,0.9c1.781,0,3.167-0.503,4.08-1.226L11,30h3.5l0.6-1.8c0.7,0.3,1.5,0.5,2.4,0.5s1.7-0.2,2.4-0.5l0.6,1.8H23h1h2v-3h1.5c2.5,0,4.5-2,4.5-4.5S30,18,27.5,18z M17.5,26.1c-0.6,0-1.1-0.1-1.5-0.4l1.5-4.3l1.5,4.3C18.6,26,18.1,26.1,17.5,26.1z M27.5,24H26v-3h1.5c0.8,0,1.5,0.7,1.5,1.5S28.3,24,27.5,24z"%3E%3C/path%3E%3C/svg%3E',
            desc: "Ambiente Teste",
            text: "Abrir"
        },
        {
            text1: "SAP 320",
            link: "",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48"%3E%3Cpath fill="%231976d2" d="M0,12v24h25l23-24H0z"%3E%3C/path%3E%3Cpath fill="%23fff" d="M27.5,18H23v7v2v0.5L19.2,18h-3.5l-3.088,7.883c-0.405-1.752-2.259-2.417-3.412-2.683C6.2,22.4,6,22,6,21.4c0-1.5,4-0.8,5-0.4c0.3-0.8,0.9-2.3,0.9-2.3S10.8,18,7.4,18C4,18,3,20.1,3,21.4c0,1.3,0.7,2.8,2.6,3.4c2,0.6,3.5,0.7,3.5,1.7s-3.4,1.2-5.3,0L3,29.1c0,0,1.1,0.9,4.4,0.9c1.781,0,3.167-0.503,4.08-1.226L11,30h3.5l0.6-1.8c0.7,0.3,1.5,0.5,2.4,0.5s1.7-0.2,2.4-0.5l0.6,1.8H23h1h2v-3h1.5c2.5,0,4.5-2,4.5-4.5S30,18,27.5,18z M17.5,26.1c-0.6,0-1.1-0.1-1.5-0.4l1.5-4.3l1.5,4.3C18.6,26,18.1,26.1,17.5,26.1z M27.5,24H26v-3h1.5c0.8,0,1.5,0.7,1.5,1.5S28.3,24,27.5,24z"%3E%3C/path%3E%3C/svg%3E',
            desc: "Ambiente Teste",
            text: "Abrir"
        },
        {
            text1: "SAP 330",
            link: "",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48"%3E%3Cpath fill="%231976d2" d="M0,12v24h25l23-24H0z"%3E%3C/path%3E%3Cpath fill="%23fff" d="M27.5,18H23v7v2v0.5L19.2,18h-3.5l-3.088,7.883c-0.405-1.752-2.259-2.417-3.412-2.683C6.2,22.4,6,22,6,21.4c0-1.5,4-0.8,5-0.4c0.3-0.8,0.9-2.3,0.9-2.3S10.8,18,7.4,18C4,18,3,20.1,3,21.4c0,1.3,0.7,2.8,2.6,3.4c2,0.6,3.5,0.7,3.5,1.7s-3.4,1.2-5.3,0L3,29.1c0,0,1.1,0.9,4.4,0.9c1.781,0,3.167-0.503,4.08-1.226L11,30h3.5l0.6-1.8c0.7,0.3,1.5,0.5,2.4,0.5s1.7-0.2,2.4-0.5l0.6,1.8H23h1h2v-3h1.5c2.5,0,4.5-2,4.5-4.5S30,18,27.5,18z M17.5,26.1c-0.6,0-1.1-0.1-1.5-0.4l1.5-4.3l1.5,4.3C18.6,26,18.1,26.1,17.5,26.1z M27.5,24H26v-3h1.5c0.8,0,1.5,0.7,1.5,1.5S28.3,24,27.5,24z"%3E%3C/path%3E%3C/svg%3E',
            desc: "Ambiente Teste",
            text: "Abrir"
        },
        {
            text1: "GIT HUB",
            link: "https://github.com/",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 50 50"%3E%3Cpath d="M17.791,46.836C18.502,46.53,19,45.823,19,45v-5.4c0-0.197,0.016-0.402,0.041-0.61C19.027,38.994,19.014,38.997,19,39 c0,0-3,0-3.6,0c-1.5,0-2.8-0.6-3.4-1.8c-0.7-1.3-1-3.5-2.8-4.7C8.9,32.3,9.1,32,9.7,32c0.6,0.1,1.9,0.9,2.7,2c0.9,1.1,1.8,2,3.4,2 c2.487,0,3.82-0.125,4.622-0.555C21.356,34.056,22.649,33,24,33v-0.025c-5.668-0.182-9.289-2.066-10.975-4.975 c-3.665,0.042-6.856,0.405-8.677,0.707c-0.058-0.327-0.108-0.656-0.151-0.987c1.797-0.296,4.843-0.647,8.345-0.714 c-0.112-0.276-0.209-0.559-0.291-0.849c-3.511-0.178-6.541-0.039-8.187,0.097c-0.02-0.332-0.047-0.663-0.051-0.999 c1.649-0.135,4.597-0.27,8.018-0.111c-0.079-0.5-0.13-1.011-0.13-1.543c0-1.7,0.6-3.5,1.7-5,c-0.5-1.7-1.2-5.3,0.2-6.6,c2.7,0,4.6,1.3,5.5,2.1,C21,13.4,22.9,13,25,13s4,0.4,5.6,1.1,c0.9-0.8,2.8-2.1,5.5-2.1c1.5,1.4,0.7,5,0.2,6.6,c1.1,1.5,1.7,3.2,1.6,5,c0,0.484-0.045,0.951-0.11,1.409,c3.499-0.172,6.527-0.034,8.204,0.102,c-0.002,0.337-0.033,0.666-0.051,0.999,c-1.671-0.138-4.775-0.28-8.359-0.089,c-0.089,0.336-0.197,0.663-0.325,0.98,c3.546,0.046,6.665,0.389,8.548,0.689,c-0.043,0.332-0.093,0.661-0.151,0.987,c-1.912-0.306-5.171-0.664-8.879-0.682,C35.112,30.873,31.557,32.75,26,32.969,V33,c2.6,0,5,3.9,5,6.6,V45,c0,0.823,0.498,1.53,1.209,1.836,C41.37,43.804,48,35.164,48,25,C48,12.318,37.683,2,25,2,S2,12.318,2,25,C2,35.164,8.63,43.804,17.791,46.836z"%3E%3C/path%3E%3C/svg%3E',
            desc: "Ambiente Teste",
            text: "Abrir"
        },
        {
            text1: "OUTLOOK",
            link: "https://outlook.office.com/mail/",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48"%3E%3Cpath fill="%2303A9F4" d="M21,31c0,1.104,0.896,2,2,2h17c1.104,0,2-0.896,2-2V16c0-1.104-0.896-2-2-2H23c-1.104,0-2,0.896-2,2V31z"%3E%3C/path%3E%3Cpath fill="%23B3E5FC" d="M42,16.975V16c0-0.428-0.137-0.823-0.367-1.148l-11.264,6.932l-7.542-4.656L22.125,19l8.459,5L42,16.975z"%3E%3C/path%3E%3Cpath fill="%230277BD" d="M27 41.46L6 37.46 6 9.46 27 5.46z"%3E%3C/path%3E%3Cpath fill="%23FFF" d="M21.216,18.311c-1.098-1.275-2.546-1.913-4.328-1.913c-1.892,0-3.408,0.669-4.554,2.003c-1.144,1.337-1.719,3.088-1.719,5.246c0,2.045,0.564,3.714,1.69,4.986c1.126,1.273,2.592,1.91,4.378,1.91c1.84,0,3.331-0.652,4.474-1.975c1.143-1.313,1.712-3.043,1.712-5.199C22.869,21.281,22.318,19.595,21.216,18.311z M19.049,26.735c-0.568,0.769-1.339,1.152-2.313,1.152c-0.939,0-1.699-0.394-2.285-1.187c-0.581-0.785-0.87-1.861-0.87-3.211c0-1.336,0.289-2.414,0.87-3.225c0.586-0.81,1.368-1.211,2.355-1.211c0.962,0,1.718,0.393,2.267,1.178c0.555,0.795,0.833,1.895,0.833,3.31C19.907,24.906,19.618,25.968,19.049,26.735z"%3E%3C/path%3E%3C/svg%3E',
            desc: "E-mail",
            text: "Abrir"
        },
        {
            text1: "Abrir",
            link: "https://tasks.office.com/docol.com.br/pt-BR/Home/Planner/",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48"%3E%3Cpath fill="%2333c481" d="M41,8v19c0,1.105-0.895,2-2,2H29V6h10C40.105,6,41,6.895,41,8z"%3E%3C/path%3E%3Cpath fill="%23107c41" d="M19,17h10v16c0,1.105-0.895,2-2,2h-8V17z"%3E%3C/path%3E%3Cpath fill="%23185c37" d="M17,42H9c-1.105,0-2-0.895-2-2V24h12v16C19,41.105,18.105,42,17,42z"%3E%3C/path%3E%3Cpath fill="%23107c41" d="M19,24H7V8c0-1.105,0.895-2,2-2h10V24z"%3E%3C/path%3E%3Crect width="10" height="11" x="19" y="6" fill="%2321a366"%3E%3C/rect%3E%3C/svg%3E',
            desc: "Planner",
            text: "Abrir"
        },
        {
            text1: "Abrir",
            link: "https://tasks.office.com/docol.com.br/pt-BR/Home/Planner/",
            svg: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="100" height="100" viewBox="0 0 48 48"%3E%3Cpath fill="%2333c481" d="M41,8v19c0,1.105-0.895,2-2,2H29V6h10C40.105,6,41,6.895,41,8z"%3E%3C/path%3E%3Cpath fill="%23107c41" d="M19,17h10v16c0,1.105-0.895,2-2,2h-8V17z"%3E%3C/path%3E%3Cpath fill="%23185c37" d="M17,42H9c-1.105,0-2-0.895-2-2V24h12v16C19,41.105,18.105,42,17,42z"%3E%3C/path%3E%3Cpath fill="%23107c41" d="M19,24H7V8c0-1.105,0.895-2,2-2h10V24z"%3E%3C/path%3E%3Crect width="10" height="11" x="19" y="6" fill="%2321a366"%3E%3C/rect%3E%3C/svg%3E',
            desc: "Ambiente Teste",
            text: "Abrir"
        },
    ];


    localforage.getItem('cardOrder').then(function(order) {
    if (order) {
        // Reorganizar os cards com base na ordem armazenada
        order.forEach(function(index) {
            createCard(appData[index], index);
        });
    } else {
        // Se a ordem ainda não estiver no cache, criar os cards na ordem padrão
        appData.forEach(function(app, index) {
            createCard(app, index);
        });
    }
});

    // Função para criar um card com base nos dados fornecidos
    function createCard(app, index) {
        var card = document.createElement("div");
        card.className = "card";
        card.draggable = true; // Torna o card arrastável
        card.setAttribute('data-index', index); // Adiciona o índice do card como um atributo

        var heading = document.createElement("h2");
        heading.innerText = app.text1;

        var img = document.createElement("img");
        img.src = app.svg;
        img.alt = "Imagem " + app.text;
        img.width = 150;

        var para = document.createElement("p");
        para.innerText = app.desc;

        var link = document.createElement("a");
        link.href = app.link;
        link.className = "button";
        link.innerText = app.text;

        // Adiciona os elementos ao card
        card.appendChild(heading);
        card.appendChild(img);
        card.appendChild(para);
        card.appendChild(link);

        // Adiciona o card ao corpo do documento
        document.body.appendChild(card);

        // Adiciona manipuladores de eventos para o card arrastável
        card.addEventListener('dragstart', handleDragStart, false);
        card.addEventListener('dragenter', handleDragEnter, false);
        card.addEventListener('dragover', handleDragOver, false);
        card.addEventListener('dragleave', handleDragLeave, false);
        card.addEventListener('drop', handleDrop, false);
        card.addEventListener('dragend', handleDragEnd, false);
    }

    // Variável para armazenar o índice do card sendo arrastado
    var dragSrcEl = null;

    // Manipuladores de eventos para o card arrastável
    function handleDragStart(e) {
        dragSrcEl = this;

        e.dataTransfer.effectAllowed = 'move';
        e.dataTransfer.setData('text/html', this.innerHTML);
    }

    function handleDragEnter(e) {
        this.classList.add('drag-over');
    }

    function handleDragOver(e) {
        if (e.preventDefault) {
            e.preventDefault();
        }
        e.dataTransfer.dropEffect = 'move';
        return false;
    }

    function handleDragLeave(e) {
        this.classList.remove('drag-over');
    }

    function handleDrop(e) {
        if (e.stopPropagation) {
            e.stopPropagation();
        }

        if (dragSrcEl !== this) {
            // Atualiza a ordem dos cards
            var cards = document.querySelectorAll('.card');
            var cardOrder = Array.from(cards).map(card => parseInt(card.getAttribute('data-index')));
            var currentIndex = parseInt(dragSrcEl.getAttribute('data-index'));
            var dropIndex = parseInt(this.getAttribute('data-index'));

            cardOrder.splice(currentIndex, 1);
            cardOrder.splice(dropIndex, 0, currentIndex);

            // Armazena a nova ordem no cache
            localforage.setItem('cardOrder', cardOrder);

            // Reorganiza os cards
            document.body.innerHTML = '';
            cardOrder.forEach(function(index) {
                createCard(appData[index], index);
            });
        }

        return false;
    }

    function handleDragEnd(e) {
        this.classList.remove('drag-over');
    }
</script>

</body>
</html>